<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
    <record id="marginality_data_view_list" model="ir.ui.view">
        <field name="name">marginality.data.view.list</field>
        <field name="model">marginality.data</field>
        <field name="arch" type="xml">
            <tree edit="1" string="Marginality Data">
                <field name="date"/>
                <field name="analytic_account_id"/>
                <field name="category" invisible="1"/>
                <field name="financial_account_id" invisible="1"/>
                <field name="journal_item_id"/>
                <field name="company_id" invisible="1"/>
                <field name="uom_id" invisible="1"/>
                <field name="quantity"/>
                <field name="product_id" invisible="1"/>
                <field name="so_item_id"/>
                <field name="so_item_policy_id" invisible="1"/>
                <field name="partner_id"/>
                <field name="employee_id" invisible="1"/>
                <field name="time_type" invisible="1"/>
                <field name="adjusted" invisible="1"/>
                <field name="multiplier" invisible="1"/>
                <field name="resource_manager_id"/>
                <field name="employee_company_id" invisible="1"/>
                <field name="employee_job_position_id" invisible="1"/>
                <field name="employee_work_country_id" invisible="1"/>
                <field name="employee_fls_geo_id" invisible="1"/>
                <field name="project_id" invisible="1"/>
                <field name="project_manager_id" invisible="1"/>
                <field name="salesperson_id"/>
                <field name="operation_manager_id" invisible="1"/>
                <field name="entry_type"/>
                <field name="status"/>
                <field name="currency_id" invisible="1"/>
                <field name="amount_currency" invisible="1"/>
                <field name="amount_usd"/>
            </tree>
        </field>
    </record>

    <record model="ir.ui.view" id="view_marginality_data_pivot">
        <field name="name">marginality.data.view.pivot</field>
        <field name="model">marginality.data</field>
        <field name="arch" type="xml">
            <pivot string="Marginality Data" display_quantity="1" sample="1">
                <field name="entry_type" type="row"/>
                <field name="amount_usd" type="measure"/>
                <field name="date" interval="year" type="col"/>
            </pivot>
        </field>
    </record>

    <record id="marginality_data_view_search" model="ir.ui.view">
        <field name="name">marginality_data_view_search</field>
        <field name="model">marginality.data</field>
        <field name="arch" type="xml">
            <search string="Marginality Data">
                <filter string="Date" name="date" date="date"/>
                <!-- <filter string="Current Year" name="current_year" domain="[('date','&gt;=', datetime.datetime(context_today().year, 1,1).strftime('%Y-%m-%d'))]"/>
                <filter 
                    string="Last Year" 
                    name="last_year" 
                    domain="[
                        ('date','&gt;=', datetime.datetime(context_today().year-1, 1,1).strftime('%Y-%m-%d')),
                        ('date','&lt;=', datetime.datetime(context_today().year-1, 12, 31).strftime('%Y-%m-%d'))
                        ]"/>
                <filter 
                    string="2 Years ago" 
                    name="two_years_ago" 
                    domain="[
                        ('date','&gt;=', datetime.datetime(context_today().year-2, 1,1).strftime('%Y-%m-%d')),
                        ('date','&lt;=', datetime.datetime(context_today().year-2, 12, 31).strftime('%Y-%m-%d'))
                        ]"/>

                <filter 
                    string="Current Quarter" 
                    name="current_year_current_quarter" 
                    domain="[
                        ('date', '&gt;=', datetime.datetime(context_today().year, ((context_today().month - 1) // 3) * 3 + 1, 1).strftime('%Y-%m-%d')),
                        ('date', '&lt;=', datetime.datetime(context_today().year, ((context_today().month - 1) // 3) * 3 + 3, 31).strftime('%Y-%m-%d'))
                    ]"/>

                <filter string="Last Quarter" name="current_quarter" domain="[('date','&gt;', datetime.datetime(context_today().year, 1,1).strftime('%Y-%m-%d'))]"/>
                <filter string="1 Quarter ago" name="current_quarter" domain="[('date','&gt;', datetime.datetime(context_today().year, 1,1).strftime('%Y-%m-%d'))]"/>
                <filter string="2 Quarter ago" name="current_quarter" domain="[('date','&gt;', datetime.datetime(context_today().year, 1,1).strftime('%Y-%m-%d'))]"/>
                <filter string="3 Quarter ago" name="current_quarter" domain="[('date','&gt;', datetime.datetime(context_today().year, 1,1).strftime('%Y-%m-%d'))]"/> -->
                <separator/>
                <filter name="entry_type" string="Type Revenue" domain="['|', ('entry_type', '=', 'actual_revenue'), ('entry_type', '=', 'analytic_revenue')]"/>
                <filter name="entry_type" string="Type Cost" domain="['|', ('entry_type', '=', 'actual_cost'), ('entry_type', '=', 'analytic_cost')]"/>
                <separator/>
                <filter name="status" string="Draft" domain="[('status', '=', 'draft')]"/>
                <filter name="status" string="In Approval" domain="[('status', '=', 'in_approval')]"/>
                <filter name="status" string="Approved" domain="[('status', '=', 'approved')]"/>
                <filter name="status" string="Posted" domain="[('status', '=', 'posted')]"/>
                <separator/>
                
                <!-- <field name="analytic_account_id"/>
                <field name="category"/>
                <field name="financial_account_id"/>
                <field name="journal_item_id"/>
                <field name="company_id"/>
                <field name="uom_id"/>
                <field name="quantity"/>
                <field name="product_id"/>
                <field name="so_item_id"/>
                <field name="so_item_policy_id"/>
                <field name="partner_id"/>
                <field name="employee_id"/>
                <field name="time_type"/>
                <field name="adjusted"/>
                <field name="multiplier"/>
                <field name="resource_manager_id"/>
                <field name="employee_company_id"/>
                <field name="employee_job_position_id"/>
                <field name="employee_work_country_id"/>
                <field name="employee_fls_geo_id"/>
                <field name="project_id"/>
                <field name="project_manager_id"/>
                <field name="salesperson_id"/>
                <field name="operation_manager_id"/>
                <field name="entry_type"/>
                <field name="status"/>
                <field name="currency_id"/>
                <field name="amount_currency"/>
                <field name="amount_usd"/> -->
                <group name="filter_group_by">
                    <filter name="filter_date" string="Date" context="{'group_by': 'date'}"/>
                    <filter name="filter_employee_id" string="Employee" context="{'group_by': 'employee_id'}"/>
                    <filter name="filter_analytic_account_id" string="Analytic Account" context="{'group_by': 'analytic_account_id'}"/>
                    <filter name="filter_partner_id" string="Partner" context="{'group_by': 'partner_id'}"/>
                    <filter name="filter_project_id" string="Project" context="{'group_by': 'project_id'}"/>
                    <filter name="filter_operation_manager_id" string="Operation Manager" context="{'group_by': 'operation_manager_id'}"/>
                    <filter name="filter_resource_manager_id" string="Resource Manager" context="{'group_by': 'resource_manager_id'}"/>
                    <filter name="filter_salesperson_id" string="Salesperson" context="{'group_by': 'salesperson_id'}"/>
                    <filter name="filter_entry_type" string="Entry Type" context="{'group_by': 'entry_type'}"/>
                    <filter name="filter_financial_account_id" string="Financial Account" context="{'group_by': 'financial_account_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="marginality_data_view_form" model="ir.ui.view">
        <field name="name">marginality_data_view_form</field>
        <field name="model">marginality.data</field>
        <field name="arch" type="xml">
            <form string="Marginality Data">
                <sheet>
                    <group>
                      <group>
                        <field name="date"/>
                        <field name="analytic_account_id"/>
                        <field name="category"/>
                        <field name="financial_account_id"/>
                        <field name="journal_item_id"/>
                        <field name="company_id"/>
                        <field name="uom_id"/>
                        <field name="quantity"/>
                        <field name="product_id"/>
                        <field name="so_item_id"/>
                        <field name="so_item_policy_id"/>
                        <field name="partner_id"/>
                        <field name="employee_id"/>
                        <field name="time_type"/>
                        <field name="adjusted"/>
                        <field name="multiplier"/>
                    </group>
                    <group>
                        <field name="resource_manager_id"/>
                        <field name="employee_company_id"/>
                        <field name="employee_job_position_id"/>
                        <field name="employee_work_country_id"/>
                        <field name="employee_fls_geo_id"/>
                        <field name="project_id"/>
                        <field name="project_manager_id"/>
                        <field name="salesperson_id"/>
                        <field name="operation_manager_id"/>
                        <field name="entry_type"/>
                        <field name="status"/>
                        <field name="currency_id"/>
                        <field name="amount_currency"/>
                        <field name="amount_usd"/>
                    </group>
                    </group>      
                </sheet>
            </form>
        </field>
    </record>


    <record id="action_marginality_data" model="ir.actions.act_window">
        <field name="name">Marginality Data</field>
        <field name="res_model">marginality.data</field>
        <field name="view_id" ref="marginality_data_view_list"/>
        <field name="view_mode">tree,form,pivot,graph</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create the first Marginality Data
            </p>
        </field>
    </record>

    <menuitem id="menu_action_marginality_data"  
        name="Marginality Data" 
        action="action_marginality_data" 
        sequence="0" 
        parent="project.menu_project_report"
        groups="base.group_system"
        />
    </data>
</odoo>
